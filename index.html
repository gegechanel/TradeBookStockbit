<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jurnal Trading Saham Indonesia</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Jurnal Trading Saham Indonesia</h1>
            <nav>
                <button id="homeBtn" class="nav-btn active">Home</button>
                <button id="portfolioBtn" class="nav-btn">Portofolio</button>
                <button id="reportBtn" class="nav-btn">Laporan</button>
                <button id="performanceBtn" class="nav-btn">Performance</button>
                <button id="addBtn" class="nav-btn">Tambah Data</button>
                <button class="nav-btn" onclick="window.location.href='calculator.html'">üßÆ Kalkulator</button>
            </nav>
        </header>

        <main>
            <!-- Home Section -->
            <section id="home" class="section active">
                <h2>Ringkasan Trading</h2>

                <!-- PHASE 1: DATE FILTER SECTION -->
                <div class="date-filter-section">
                    <h3>üìÖ Filter Periode Analisis</h3>
                    
                    <!-- Quick Filters -->
                    <div class="quick-filters">
                        <div class="filter-buttons">
                            <button class="filter-btn" data-range="all">Semua Data</button>
                            <button class="filter-btn active" data-range="30days">30 Hari Terakhir</button>
                            <button class="filter-btn" data-range="7days">7 Hari Terakhir</button>
                            <button class="filter-btn" data-range="thismonth">Bulan Ini</button>
                            <button class="filter-btn" data-range="lastmonth">Bulan Lalu</button>
                            <button class="filter-btn" data-range="thisyear">Tahun Ini</button>
                            
                        </div>
                    </div>
                    
                    <!-- Custom Range -->
                    <div class="custom-range">
                        <div class="range-inputs">
                            <div class="input-group">
                                <label for="startDate">Dari:</label>
                                <input type="date" id="startDate">
                            </div>
                            <div class="input-group">
                                <label for="endDate">Sampai:</label>
                                <input type="date" id="endDate">
                            </div>
                        </div>
                        <div class="range-actions">
                            <button id="applyDateFilter" class="btn-primary">Terapkan Filter</button>
                            <button id="resetDateFilter" class="btn-secondary">Reset</button>
                        </div>
                    </div>
                    
                    <!-- Applied Filter Display -->
                    <div id="filterStatus" class="filter-status">
                        <span id="filterText">Menampilkan semua data trading</span>
                        <span id="filterInfo" class="filter-info"></span>
                    </div>
                </div>
                
                <!-- COMPARISON TOGGLE -->
                <div class="comparison-toggle">
                    <label class="toggle-label">
                        <input type="checkbox" id="compareToggle">
                        <span class="toggle-slider"></span>
                        <span class="toggle-text">Tampilkan perbandingan dengan periode sebelumnya</span>
                    </label>
                </div>
                
                <!-- ENHANCED METRICS SECTION -->
                <div class="metrics-section">
                    <h3>üìä Performance Metrics</h3>
                    <div class="metrics-grid">
                        <!-- Row 1 -->
                        <div class="metric-card">
                            <div class="metric-label">TOTAL P/L</div>
                            <div class="metric-value" id="filteredTotalPL">Rp 0</div>
                            <div class="metric-trend" id="plTrend"></div>
                        </div>
                        
                        <div class="metric-card">
                            <div class="metric-label">WIN RATE</div>
                            <div class="metric-value" id="filteredWinRate">0%</div>
                            <div class="metric-trend" id="winRateTrend"></div>
                        </div>
                        
                        <div class="metric-card">
                            <div class="metric-label">TOTAL TRADES</div>
                            <div class="metric-value" id="filteredTotalTrades">0</div>
                            <div class="metric-trend" id="tradesTrend"></div>
                        </div>
                        
                        <!-- Row 2 -->
                        <div class="metric-card">
                            <div class="metric-label">AVG PROFIT/TRADE</div>
                            <div class="metric-value" id="filteredAvgProfit">Rp 0</div>
                            <div class="metric-trend" id="avgProfitTrend"></div>
                        </div>
                        
                        <div class="metric-card">
                            <div class="metric-label">MAX PROFIT</div>
                            <div class="metric-value" id="filteredMaxProfit">Rp 0</div>
                            <div class="metric-trend" id="maxProfitTrend"></div>
                        </div>
                        
                        <div class="metric-card">
                            <div class="metric-label">MAX LOSS</div>
                            <div class="metric-value" id="filteredMaxLoss">Rp 0</div>
                            <div class="metric-trend" id="maxLossTrend"></div>
                        </div>
                    </div>
                </div>
                
                <!-- COMPARISON SECTION (Hidden by default) -->
                <div id="comparisonSection" class="comparison-section" style="display: none;">
                    <h4>üîÑ Perbandingan dengan Periode Sebelumnya</h4>
                    <div class="comparison-metrics">
                        <!-- Comparison data akan diisi oleh JavaScript -->
                    </div>
                </div>

                <!-- ===== PHASE 2: CHART CONTROLS & STOCK TABLE ===== -->

                <!-- Chart Type Selector -->
                <div class="chart-controls-section">
                    <div class="chart-header">
                        <h3>üìà Chart Analytics</h3>
                        <div class="chart-type-selector">
                            <button class="chart-type-btn active" data-chart-type="line">
                                <span class="btn-icon">üìà</span>
                                Line Chart
                            </button>
                            <button class="chart-type-btn" data-chart-type="bar">
                                <span class="btn-icon">üìä</span>
                                Bar Chart
                            </button>
                            <button class="chart-type-btn" data-chart-type="breakdown">
                                <span class="btn-icon">üîç</span>
                                Daily Breakdown
                            </button>
                        </div>
                    </div>
                    
                    <!-- Chart Period Info -->
                    <div class="chart-period-info">
                        <span id="chartPeriodText">Profit/Loss 7 hari terakhir</span>
                        <span class="chart-data-info" id="chartDataInfo"></span>
                    </div>
                </div>
                
                <!-- Stock Performance Table -->
                <div class="stock-table-section">
                    <div class="section-header">
                        <h3>üìã Top Performing Stocks</h3>
                        <div class="table-controls">
                            <button class="table-action-btn" id="refreshStockTable">
                                <span class="btn-icon">üîÑ</span>
                                Refresh
                            </button>
                            <button class="table-action-btn" id="exportStockTable">
                                <span class="btn-icon">üì•</span>
                                Export
                            </button>
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <table id="stockPerformanceTable">
                            <thead>
                                <tr>
                                    <th data-sort="stock" class="sortable">
                                        <span>STOCK</span>
                                        <span class="sort-icon">‚ÜïÔ∏è</span>
                                    </th>
                                    <th data-sort="trades" class="sortable">
                                        <span>TRADES</span>
                                        <span class="sort-icon">‚ÜïÔ∏è</span>
                                    </th>
                                    <th data-sort="totalPL" class="sortable sort-desc">
                                        <span>TOTAL P/L</span>
                                        <span class="sort-icon">‚Üì</span>
                                    </th>
                                    <th data-sort="winRate" class="sortable">
                                        <span>WIN RATE</span>
                                        <span class="sort-icon">‚ÜïÔ∏è</span>
                                    </th>
                                    <th>ACTIONS</th>
                                </tr>
                            </thead>
                            <tbody id="stockTableBody">
                                <!-- Data akan diisi oleh JavaScript -->
                                <tr class="loading-row">
                                    <td colspan="5" style="text-align: center;">
                                        <div class="loading-spinner-small"></div>
                                        Loading stock data...
                                    </td>
                                </tr>
                            </tbody>
                            <tfoot>
                                <tr>
                                    <td colspan="5" class="table-footer">
                                        <div class="footer-info">
                                            <span id="tableSummary">Showing top 5 stocks by Total P/L</span>
                                            <span class="record-count" id="stockCount">0 stocks</span>
                                        </div>
                                    </td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
                
                <!-- Insights Panel -->
                <div class="insights-section">
                    <div class="section-header">
                        <h3>üí° Trading Insights</h3>
                        <button class="insights-refresh" id="refreshInsights">
                            <span class="btn-icon">üé≤</span>
                            Generate New Insights
                        </button>
                    </div>
                    
                    <div class="insights-container">
                        <div class="insight-card">
                            <div class="insight-header">
                                <span class="insight-icon">üìà</span>
                                <h4>Performance Highlights</h4>
                            </div>
                            <div class="insight-content" id="insightPerformance">
                                <div class="loading-placeholder">
                                    <div class="loading-bar"></div>
                                    <div class="loading-bar"></div>
                                    <div class="loading-bar"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="insight-card">
                            <div class="insight-header">
                                <span class="insight-icon">üìä</span>
                                <h4>Trading Patterns</h4>
                            </div>
                            <div class="insight-content" id="insightPatterns">
                                <div class="loading-placeholder">
                                    <div class="loading-bar"></div>
                                    <div class="loading-bar"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="insight-card">
                            <div class="insight-header">
                                <span class="insight-icon">‚ö†Ô∏è</span>
                                <h4>Risk Indicators</h4>
                            </div>
                            <div class="insight-content" id="insightRisks">
                                <div class="loading-placeholder">
                                    <div class="loading-bar"></div>
                                    <div class="loading-bar"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                
                                
                <div class="charts">
                    <div class="chart-container">
                        <h3>Profit/Loss 7 hari Terakhir</h3>
                        <canvas id="lineChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>Distribusi Metode Trading</h3>
                        <canvas id="pieChart"></canvas>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="dashboard-actions">
                    <button class="action-btn primary" id="viewDetailedReport">
                        <span class="btn-icon">üìÑ</span>
                        View Detailed Report
                    </button>
                    <button class="action-btn secondary" id="exportDashboard">
                        <span class="btn-icon">üì•</span>
                        Export Dashboard
                    </button>
                </div>
            </section>

            <!-- Add Data Section -->
            <section id="add-data" class="section">
                <h2>Tambah Data Trading</h2>
                <!-- ‚≠ê‚≠ê BARU: Toggle Switch untuk Posisi Trading ‚≠ê‚≠ê -->
                <div class="form-group">
                    <div class="toggle-switch">
                        <input type="checkbox" id="positionModeToggle" class="toggle-input">
                        <label for="positionModeToggle" class="toggle-label">
                            <span class="toggle-text">Trading Biasa</span>
                            <span class="toggle-slider"></span>
                            <span class="toggle-text">Posisi Saham</span>
                        </label>
                    </div>
                    <div class="toggle-description">
                        <span id="toggleDesc">1x Buy + 1x Sell dalam 1 trading</span>
                    </div>
                </div>
                
                <!-- ‚≠ê‚≠ê BARU: Position Selection (Hidden by Default) ‚≠ê‚≠ê -->
                <div id="positionSelection" class="form-group" style="display: none;">
                    <label for="positionType">Jenis Transaksi:</label>
                    <select id="positionType" class="position-select">
                        <option value="new">Beli - Buat Posisi Baru</option>
                        <option value="add">Beli - Tambah ke Posisi Existing</option>
                        <option value="close">Jual - Tutup Posisi</option>
                        <option value="partial">Jual - Partial Exit</option>
                    </select>
                </div>
                
                <!-- ‚≠ê‚≠ê BARU: Existing Positions Dropdown (Hidden by Default) ‚≠ê‚≠ê -->
                <div id="existingPositionsContainer" class="form-group" style="display: none;">
                    <label for="existingPositions">Pilih Posisi:</label>
                    <select id="existingPositions" class="position-select">
                        <option value="">-- Pilih Posisi --</option>
                    </select>
                    <div id="positionInfo" class="position-info" style="display: none;">
                        <!-- Position info akan diisi oleh JavaScript -->
                    </div>
                </div>
                
                <!-- ‚≠ê‚≠ê BARU: Partial Exit Fields (Hidden by Default) ‚≠ê‚≠ê -->
                <div id="partialExitContainer" class="form-group" style="display: none;">
                    <label for="partialLot">Jumlah LOT Jual:</label>
                    <input type="number" id="partialLot"  value="1">
                    <div class="fee-info">Dari total: <span id="totalAvailableLot">0</span> lot</div>
                </div>
                
                <!-- ‚≠ê‚≠ê BARU: Position Preview ‚≠ê‚≠ê -->
                <div id="positionPreview" class="position-preview" style="display: none;">
                    <!-- Preview akan diisi oleh JavaScript -->
                </div>
                <form id="tradingForm">
                    <div class="form-group">
                        <label for="tanggalMasuk">Tanggal Masuk:</label>
                        <input type="date" id="tanggalMasuk" >
                    </div>
                    
                    <div class="form-group">
                        <label for="tanggalKeluar">Tanggal Keluar:</label>
                        <input type="date" id="tanggalKeluar">
                    </div>
                    
                    <div class="form-group">
                        <label for="kodeSaham">Kode Saham:</label>
                        <input type="text" id="kodeSaham" placeholder="Contoh: BBCA, TLKM" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="hargaMasuk">Harga Masuk:</label>
                        <input type="number" id="hargaMasuk" step="0.01" placeholder="Rp" >
                    </div>
                    
                    <div class="form-group">
                        <label for="hargaKeluar">Harga Keluar:</label>
                        <input type="number" id="hargaKeluar" step="0.01" placeholder="Rp">
                    </div>
                    
                    <div class="form-group">
                        <label for="lot">Jumlah LOT:</label>
                        <input type="number" id="lot" step="1" value="1">
                    </div>

                    <!-- Kolom Fee sesuai struktur baru -->
                    <div class="form-group">
                        <label for="feeBuy">Fee Beli (Rp):</label>
                        <input type="number" id="feeBuy" step="0.01" placeholder="Kosongkan untuk fee otomatis">
                        <div class="fee-info">Fee otomatis: 0.1513% dari nilai beli</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="feeSell">Fee Jual (Rp):</label>
                        <input type="number" id="feeSell" step="0.01" placeholder="Kosongkan untuk fee otomatis">
                        <div class="fee-info">Fee otomatis: 0.25132% dari nilai jual</div>
                    </div>
                    
                   
                    <div class="form-group">
                        <label for="metodeTrading">Metode Trading:</label>
                        <select id="metodeTrading" required>
                            <option value="">Pilih Metode</option>
                            <option value="Scalping">Scalping</option>
                            <option value="Day Trade">Day Trade</option>
                            <option value="BSJP">BSJP</option>
                            <option value="Swing">Swing</option>
                            <option value="Investasi">Investasi</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="catatan">Catatan:</label>
                        <textarea id="catatan" rows="3" placeholder="Catatan tambahan tentang trading ini"></textarea>
                    </div>                  
                    <div class="form-actions">
                        <button type="submit" id="submitBtn">Simpan Data</button>
                        
                        <button type="reset" id="resetBtn">Reset</button>
                    </div>
                </form>
            </section>

            <!-- Report Section -->
            <section id="report" class="section">
                <h2>Laporan Trading</h2>
                
                <div class="filters">
                    <div class="filter-group">
                        <label for="filterMetode">Filter Metode:</label>
                        <select id="filterMetode">
                            <option value="">Semua</option>
                            <option value="Scalping">Scalping</option>
                            <option value="Day Trade">Day Trade</option>
                            <option value="Swing">Swing</option>
                            <option value="Investasi">Investasi</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="filterBulan">Filter Bulan:</label>
                        <input type="month" id="filterBulan">
                    </div>
                    
                    <div class="filter-group">
                        <label for="filterSaham">Filter Saham:</label>
                        <input type="text" id="filterSaham" placeholder="Kode saham">
                    </div>
                    
                    <button id="applyFilters">Terapkan Filter</button>
                    <button id="resetFilters">Reset Filter</button>
                </div>
                
                <div class="table-container">
                    <table id="tradingTable">
                        <thead>
                            <tr>
                                <th>Tanggal Masuk</th>
                                <th>Tanggal Keluar</th>
                                <th>Kode Saham</th>
                                <th>Harga Masuk</th>
                                <th>Harga Keluar</th>
                                <th>LOT</th>
                                <th>Fee Buy</th>
                                <th>Fee Sell</th>
                                <th>Total Fee</th>
                                <th>Metode</th>
                                <th>P/L</th>
                                <th>Catatan</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="tradingTableBody">
                            <!-- Data akan diisi oleh JavaScript -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Performance Section -->
            <section id="performance" class="section">
                <h2>Analisis Performance</h2>
                
                <div class="performance-tabs">
                    <button class="perf-tab active" data-tab="saham">Performance by Saham</button>
                    <button class="perf-tab" data-tab="metode">Win Rate by Metode</button>
                    <button class="perf-tab" data-tab="summary">Summary Trading</button>
                </div>
                
                <!-- Performance by Saham -->
                <div id="tab-saham" class="perf-tab-content active">
                    <h3>Performance per Kode Saham</h3>
                    <div class="table-container">
                        <table id="sahamPerformanceTable">
                            <thead>
                                <tr>
                                    <th>Kode Saham</th>
                                    <th>Total Trading</th>
                                    <th>Win</th>
                                    <th>Loss</th>
                                    <th>Win Rate</th>
                                    <th>Total Profit</th>
                                    <th>Avg Profit</th>
                                    <th>Best Trade</th>
                                    <th>Worst Trade</th>
                                </tr>
                            </thead>
                            <tbody id="sahamPerformanceBody">
                                <!-- Data akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Win Rate by Metode -->
                <div id="tab-metode" class="perf-tab-content">
                    <h3>Win Rate per Metode Trading</h3>
                    <div class="table-container">
                        <table id="metodePerformanceTable">
                            <thead>
                                <tr>
                                    <th>Metode Trading</th>
                                    <th>Total Trading</th>
                                    <th>Win</th>
                                    <th>Loss</th>
                                    <th>Win Rate</th>
                                    <th>Total Profit</th>
                                    <th>Avg Profit</th>
                                    <th>Success Rate</th>
                                </tr>
                            </thead>
                            <tbody id="metodePerformanceBody">
                                <!-- Data akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Summary Trading -->
                <div id="tab-summary" class="perf-tab-content">
                    <h3>Summary Trading Lengkap</h3>
                    <div class="summary-cards">
                        <div class="card">
                            <h3>Total Semua Trading</h3>
                            <p id="totalAllTrades">0</p>
                        </div>
                        <div class="card">
                            <h3>Total Win</h3>
                            <p id="totalWins">0</p>
                        </div>
                        <div class="card">
                            <h3>Total Loss</h3>
                            <p id="totalLosses">0</p>
                        </div>
                        <div class="card">
                            <h3>Overall Win Rate</h3>
                            <p id="overallWinRate">0%</p>
                        </div>
                    </div>
                    
                    <div class="charts">
                        <div class="chart-container">
                            <h3>Distribusi Profit/Loss</h3>
                            <canvas id="distributionChart"></canvas>
                        </div>
                        <div class="chart-container">
                            <h3>Win Rate per Metode</h3>
                            <canvas id="winRateChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>
                        <!-- Portfolio Section -->
            <section id="portfolio" class="section">
                <h2>üìä Portofolio Trading</h2>
                
                <!-- Portfolio Metrics -->
                <div class="portfolio-metrics">
                    <div class="portfolio-card">
                        <div class="portfolio-icon">üí∞</div>
                        <div class="portfolio-content">
                            <div class="portfolio-label">TOTAL TOP UP</div>
                            <div class="portfolio-value" id="totalTopUp">Rp 0</div>
                            <div class="portfolio-change" id="topUpChange">+0% bulan ini</div>
                        </div>
                    </div>
                    
                    <div class="portfolio-card">
                        <div class="portfolio-icon">üí∏</div>
                        <div class="portfolio-content">
                            <div class="portfolio-label">TOTAL WITHDRAW</div>
                            <div class="portfolio-value" id="totalWithdraw">Rp 0</div>
                            <div class="portfolio-change" id="withdrawChange">+0% bulan ini</div>
                        </div>
                    </div>
                    
                    <div class="portfolio-card">
                        <div class="portfolio-icon">üìà</div>
                        <div class="portfolio-content">
                            <div class="portfolio-label">TOTAL EQUITY</div>
                            <div class="portfolio-value" id="totalEquity">Rp 0</div>
                            <div class="portfolio-change" id="equityChange">
                                <span class="trend-up">+0%</span> all time
                            </div>
                        </div>
                    </div>
                    
                    <div class="portfolio-card">
                        <div class="portfolio-icon">üíµ</div>
                        <div class="portfolio-content">
                            <div class="portfolio-label">TOTAL CASH</div>
                            <div class="portfolio-value" id="totalCash">Rp 0</div>
                            <div class="portfolio-change" id="cashChange">
                                <span class="trend-neutral">0%</span> dari equity
                            </div>
                        </div>
                    </div>
                    
                    <div class="portfolio-card highlight">
                        <div class="portfolio-icon">üöÄ</div>
                        <div class="portfolio-content">
                            <div class="portfolio-label">GROWTH</div>
                            <div class="portfolio-value" id="growthValue">0%</div>
                            <div class="portfolio-change" id="growthChange">
                                <span class="trend-up">+0%</span> vs modal awal
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Portfolio Breakdown -->
                <div class="portfolio-breakdown">
                    <div class="breakdown-card">
                        <h3>üìä Breakdown Portofolio</h3>
                        <div class="breakdown-content">
                            <div class="breakdown-item">
                                <span class="breakdown-label">Modal Awal</span>
                                <span class="breakdown-value" id="initialCapital">Rp 0</span>
                            </div>
                            <div class="breakdown-item">
                                <span class="breakdown-label">Total P/L Trading</span>
                                <span class="breakdown-value positive" id="totalTradingPL">+Rp 0</span>
                            </div>
                            <div class="breakdown-item">
                                <span class="breakdown-label">Net Cash Flow</span>
                                <span class="breakdown-value" id="netCashFlow">Rp 0</span>
                            </div>
                            <div class="breakdown-item total">
                                <span class="breakdown-label">Total Equity</span>
                                <span class="breakdown-value" id="calculatedEquity">Rp 0</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="breakdown-card">
                        <h3>üìà Growth Chart</h3>
                        <div class="chart-container-small">
                            <canvas id="growthChart"></canvas>
                        </div>
                        <div class="chart-legend">
                            <div class="legend-item">
                                <span class="legend-color" style="background-color: #3498db;"></span>
                                <span>Modal</span>
                            </div>
                            <div class="legend-item">
                                <span class="legend-color" style="background-color: #2ecc71;"></span>
                                <span>Equity</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Transaction History -->
                <div class="transaction-history">
                    <div class="section-header">
                        <h3>üìã Riwayat Transaksi Dana</h3>
                        <div class="table-controls">
                            <button class="table-action-btn" id="exportTransactions">
                                <span class="btn-icon">üì•</span>
                                Export
                            </button>
                            <button class="table-action-btn" id="filterTransactions">
                                <span class="btn-icon">üîç</span>
                                Filter
                            </button>
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <table id="transactionTable">
                            <thead>
                                <tr>
                                    <th>Tanggal</th>
                                    <th>Jenis</th>
                                    <th>Jumlah</th>
                                    <th>Metode</th>
                                    <th>Keterangan</th>
                                    <th>Saldo Setelah</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="transactionTableBody">
                                <tr class="loading-row">
                                    <td colspan="7" style="text-align: center;">
                                        <div class="loading-spinner-small"></div>
                                        Loading transaction history...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="portfolio-actions">
                    <button class="action-btn primary" id="addTopUpBtn">
                        <span class="btn-icon">‚ûï</span>
                        Top Up Dana
                    </button>
                    <button class="action-btn secondary" id="addWithdrawBtn">
                        <span class="btn-icon">‚ûñ</span>
                        Withdraw Dana
                    </button>
                    <button class="action-btn tertiary" id="viewCashFlowBtn">
                        <span class="btn-icon">üìä</span>
                        Cash Flow Report
                    </button>
                </div>
            </section>
            
        </main>
    </div>

    <!-- Modal untuk Edit Data -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Edit Data Trading</h2>
            <form id="editForm">
                <input type="hidden" id="editId">
                
                <div class="form-group">
                    <label for="editTanggalMasuk">Tanggal Masuk:</label>
                    <input type="date" id="editTanggalMasuk" required>
                </div>
                
                <div class="form-group">
                    <label for="editTanggalKeluar">Tanggal Keluar:</label>
                    <input type="date" id="editTanggalKeluar">
                </div>
                
                <div class="form-group">
                    <label for="editKodeSaham">Kode Saham:</label>
                    <input type="text" id="editKodeSaham" required>
                </div>
                
                <div class="form-group">
                    <label for="editHargaMasuk">Harga Masuk:</label>
                    <input type="number" id="editHargaMasuk" step="0.01" required>
                </div>
                
                <div class="form-group">
                    <label for="editHargaKeluar">Harga Keluar:</label>
                    <input type="number" id="editHargaKeluar" step="0.01">
                </div>
                
                <div class="form-group">
                    <label for="editLot">Jumlah LOT:</label>
                    <input type="number" id="editLot" step="1"  required>
                </div>
                
                <!-- Kolom Fee untuk Edit -->
                <div class="form-group">
                    <label for="editFeeBuy">Fee Beli (Rp):</label>
                    <input type="number" id="editFeeBuy" step="0.01" placeholder="Kosongkan untuk fee otomatis">
                    <div class="fee-info">Fee otomatis: 0.1513% dari nilai beli</div>
                </div>
                
                <div class="form-group">
                    <label for="editFeeSell">Fee Jual (Rp):</label>
                    <input type="number" id="editFeeSell" step="0.01" placeholder="Kosongkan untuk fee otomatis">
                    <div class="fee-info">Fee otomatis: 0.25132% dari nilai jual</div>
                </div>
               
                <div class="form-group">
                    <label for="editMetodeTrading">Metode Trading:</label>
                    <select id="editMetodeTrading" required>
                        <option value="Scalping">Scalping</option>
                        <option value="Day Trade">Day Trade</option>
                        <option value="BSJP">BSJP</option>
                        <option value="Swing">Swing</option>
                        <option value="Investasi">Investasi</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="editCatatan">Catatan:</label>
                    <textarea id="editCatatan" rows="3"></textarea>
                </div>               
                <div class="form-actions">
                    <button type="submit" id="updateBtn" class="btn-primary">Update Data</button>
                  
                    <button type="button" id="cancelEdit" class="btn-secondary">Batal</button>
                </div>
            </form>
        </div>
    </div>
    <!-- Custom Notification Modal -->
    <div id="notificationModal" class="notification-modal">
        <div class="notification-content" id="notificationContent">
            <div class="notification-icon" id="notificationIcon">üíæ</div>
            <div class="notification-title" id="notificationTitle">Notification</div>
            <div class="notification-message" id="notificationMessage">Message will appear here</div>
            <button class="notification-btn" id="notificationBtn">OK</button>
        </div>
    </div>
        <!-- Loading Modal -->
    <div id="loadingModal" class="loading-modal">
        <div class="loading-content" id="loadingContent">
            <div class="loading-icon">
                <div class="loading-spinner-large" id="loadingSpinner"></div>
                <div class="loading-success" id="loadingSuccess" style="display: none;">‚úÖ</div>
                <div class="loading-error" id="loadingError" style="display: none;">‚ùå</div>
            </div>
            
            <h3 id="loadingTitle">Memuat Data Trading</h3>
            <p id="loadingMessage">Sedang mengambil data dari Google Sheets...</p>
            
            <div class="loading-progress">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <span class="progress-text" id="progressText">0%</span>
            </div>
            
            <div class="loading-details">
                <div class="loading-item">
                    <span class="loading-label">Status:</span>
                    <span class="loading-value" id="loadingStatus">Menyiapkan aplikasi...</span>
                </div>
                <div class="loading-item">
                    <span class="loading-label">Data Loaded:</span>
                    <span class="loading-value" id="dataLoaded">0 records</span>
                </div>
                <div class="loading-item">
                    <span class="loading-label">Pending Data:</span>
                    <span class="loading-value" id="pendingData">0 records</span>
                </div>
            </div>
            
            <!-- Error Section (hidden by default) -->
            <div class="error-section" id="errorSection" style="display: none;">
                <div class="error-message" id="errorMessage"></div>
                <div class="error-actions">
                    <button class="retry-btn" id="retryBtn">üîÑ Coba Lagi</button>
                    <button class="continue-btn" id="continueBtn">üöÄ Lanjutkan Anyway</button>
                </div>
            </div>
            
            <!-- Success Section (hidden by default) -->
            <div class="success-section" id="successSection" style="display: none;">
                <button class="success-btn" id="successBtn">üéâ Mulai Trading!</button>
            </div>
        </div>
    </div>
        <!-- Modal untuk Top Up -->
    <div id="topUpModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>üí∞ Top Up Dana</h2>
            <form id="topUpForm">
                <div class="form-group">
                    <label for="topUpAmount">Jumlah (Rp):</label>
                    <input type="number" id="topUpAmount"  min="1000" required>
                    <div class="quick-amounts">
                        <button type="button" class="quick-amount" data-amount="1000000">1 Juta</button>
                        <button type="button" class="quick-amount" data-amount="5000000">5 Juta</button>
                        <button type="button" class="quick-amount" data-amount="10000000">10 Juta</button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="topUpMethod">Metode Transfer:</label>
                    <select id="topUpMethod" required>
                        <option value="">Pilih Metode</option>
                        <option value="bank_transfer">Transfer Bank</option>
                        <option value="e_wallet">E-Wallet</option>
                        <option value="cash">Tunai</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="topUpNotes">Keterangan (Opsional):</label>
                    <textarea id="topUpNotes" rows="2" placeholder="Contoh: Tambahan modal trading"></textarea>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn-primary">Konfirmasi Top Up</button>
                    <button type="button" class="btn-secondary" id="cancelTopUp">Batal</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Modal untuk Withdraw -->
    <div id="withdrawModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>üí∏ Withdraw Dana</h2>
            <div class="balance-info">
                <div class="info-item">
                    <span>Available Cash:</span>
                    <span id="availableCash">Rp 0</span>
                </div>
                <div class="info-item">
                    <span>Max Withdraw:</span>
                    <span id="maxWithdraw">Rp 0</span>
                </div>
            </div>
            
            <form id="withdrawForm">
                <div class="form-group">
                    <label for="withdrawAmount">Jumlah (Rp):</label>
                    <input type="number" id="withdrawAmount"  min="1000" required>
                    <div class="quick-percentages">
                        <button type="button" class="quick-percent" data-percent="25">25%</button>
                        <button type="button" class="quick-percent" data-percent="50">50%</button>
                        <button type="button" class="quick-percent" data-percent="75">75%</button>
                        <button type="button" class="quick-percent" data-percent="100">100%</button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="withdrawMethod">Metode Penarikan:</label>
                    <select id="withdrawMethod" required>
                        <option value="">Pilih Metode</option>
                        <option value="bank_transfer">Transfer Bank</option>
                        <option value="cash">Tunai</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="withdrawNotes">Keterangan (Opsional):</label>
                    <textarea id="withdrawNotes" rows="2" placeholder="Contoh: Dana darurat"></textarea>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn-primary">Konfirmasi Withdraw</button>
                    <button type="button" class="btn-secondary" id="cancelWithdraw">Batal</button>
                </div>
            </form>
        </div>
    </div>
    <script src="script-refactor.js"></script>
    
</body>
</html>





















